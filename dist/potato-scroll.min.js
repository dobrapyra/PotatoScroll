/**
 * PotatoScroll
 * author: dobrapyra (Michał Zieliński)
 * version "0.2.0"
 */
window.PotatoScroll=function(e){var t={};function o(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=e,o.c=t,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(s,i,function(t){return e[t]}.bind(null,i));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o(1);var s,i=o(2),n=(s=i)&&s.__esModule?s:{default:s};t.default=n.default},function(e,t,o){},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,o,s){return o&&e(t.prototype,o),s&&e(t,s),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setVars(t)&&(this.analyzeNative(),this.prepareDOM(),this.hideNativeBars(),this.addCustomBars(),this.bindEvents(),this.bindBarsEvents(),this.refresh(),setTimeout(this.refreshParents.bind(this)))}return s(e,null,[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.selector;return Array.prototype.map.call(document.querySelectorAll(o),(function(o){var s=Object(t);return s.el=o,new e(s)}))}}]),s(e,[{key:"setVars",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(){},o=e.el,s=e.cssClass,i=void 0===s?"potatoScroll":s,n=e.forceCustom,l=void 0!==n&&n,r=e.forceSize,a=void 0===r?20:r,c=e.onNativeScroll,v=void 0===c?t:c,h=e.onScroll,u=void 0===h?t:h,d=e.onTop,f=void 0===d?t:d,m=e.onBottom,p=void 0===m?t:m,y=e.onLeft,b=void 0===y?t:y,E=e.onRight,S=void 0===E?t:E;return!!o&&(this.rootEl=o,this.cssClass=i,this.forceCustom=l,this.event={onNativeScroll:v,onScroll:u,onTop:f,onBottom:p,onLeft:b,onRight:S},this.progress={v:0,h:0},this.scrollWait=!1,this.resizeWait=!1,this.bar={v:{forceSize:l?a:0,nativeSize:0,el:null,moveStart:null,moveDiff:0,scrollBefore:null,size:0,sizeFract:1,moveProp:"clientY",scrollProp:"scrollTop"},h:{forceSize:l?a:0,nativeSize:0,el:null,moveStart:null,moveDiff:0,scrollBefore:null,size:0,sizeFract:1,moveProp:"clientX",scrollProp:"scrollLeft"}},this.activeBarObj=null,!0)}},{key:"analyzeNative",value:function(){var e=document.documentElement,t=document.createElement("div");t.style.overflow="scroll",t.style.width="100px",t.style.height="100px",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.visibility="hidden";var o=document.createElement("div");t.appendChild(o),e.appendChild(t);var s=t.offsetWidth-t.scrollWidth,i=t.offsetHeight-t.scrollHeight;this.bar.v.nativeSize=s,this.bar.h.nativeSize=i,s>0&&(this.bar.v.forceSize=0),i>0&&(this.bar.h.forceSize=0),e.removeChild(t)}},{key:"prepareDOM",value:function(){var e=this.rootEl,t=this.cssClass;e.classList.add(t),e.style.overflow="visible",e.style.position="relative",e.style.display="flex";var o=document.createElement("div");o.classList.add(t+"__mask"),o.style.flexGrow=1,o.style.overflow="hidden",o.style.position="relative",o.style.display="flex",o.style.zIndex="0";var s=document.createElement("div");for(s.classList.add(t+"__scroll"),s.style.flexGrow=1,s.style.overflow="scroll";e.childNodes.length;)s.appendChild(e.childNodes[0]);o.appendChild(s),e.appendChild(o),this.maskEl=o,this.scrollEl=s}},{key:"hideNativeBars",value:function(){var e=this.scrollEl,t=this.bar;if(this.forceCustom&&(0===t.v.nativeSize||0===t.h.nativeSize)){var o=t.v.forceSize;e.style.marginLeft=-o+"px",e.style.paddingLeft=o+"px",e.style.marginRight=-o+"px",e.style.paddingRight=o+"px";var s=t.v.forceSize;return e.style.marginBottom=-s+"px",void(e.style.paddingBottom=s+"px")}e.style.marginRight=-t.h.nativeSize+"px",e.style.marginBottom=-t.v.nativeSize+"px"}},{key:"addCustomBars",value:function(){var e=this.cssClass,t=this.bar,o=this.rootEl;if(0!==t.v.nativeSize||0!==t.h.nativeSize||this.forceCustom){var s=document.createElement("div");s.classList.add(e+"__track"),s.classList.add(e+"__track--v"),s.style.position="absolute",s.style.zIndex="1",t.v.trackEl=s;var i=document.createElement("div");i.classList.add(e+"__bar"),i.classList.add(e+"__bar--v"),t.v.el=i;var n=document.createElement("div");n.classList.add(e+"__track"),n.classList.add(e+"__track--h"),n.style.position="absolute",n.style.zIndex="1",t.h.trackEl=n;var l=document.createElement("div");l.classList.add(e+"__bar"),l.classList.add(e+"__bar--h"),t.h.el=l,s.appendChild(i),n.appendChild(l),o.appendChild(s),o.appendChild(n)}}},{key:"bindEvents",value:function(){this.onScroll=this.onScroll.bind(this),this.onScrollThrottle=this.onScrollThrottle.bind(this),this.onResize=this.onResize.bind(this),this.onResizeThrottle=this.onResizeThrottle.bind(this),this.onNestedCreate=this.onNestedCreate.bind(this),this.scrollEl.addEventListener("scroll",this.onScrollThrottle),window.addEventListener("resize",this.onResizeThrottle),this.rootEl.addEventListener("PotatoScroll.nestedCreate",this.onNestedCreate)}},{key:"onScrollThrottle",value:function(e){this.event.onNativeScroll(e,this.rootEl),this.scrollWait||(this.scrollWait=!0,this.raf=requestAnimationFrame(this.onScroll))}},{key:"onScroll",value:function(){this.setBarsPos(),this.scrollWait=!1}},{key:"onResizeThrottle",value:function(){this.resizeWait||(this.resizeWait=!0,this.raf=requestAnimationFrame(this.onResize))}},{key:"onResize",value:function(){this.refresh(),this.resizeWait=!1}},{key:"onNestedCreate",value:function(){this.refresh()}},{key:"bindBarsEvents",value:function(){this.onDocMouseMove=this.onDocMouseMove.bind(this),this.onDocMouseUp=this.onDocMouseUp.bind(this),this.onDocMouseLeave=this.onDocMouseLeave.bind(this),this.onVBarMouseDown=this.onVBarMouseDown.bind(this),this.onHBarMouseDown=this.onHBarMouseDown.bind(this),this.bar.v.el&&this.bar.v.el.addEventListener("mousedown",this.onVBarMouseDown),this.bar.h.el&&this.bar.h.el.addEventListener("mousedown",this.onHBarMouseDown)}},{key:"bindDocEvents",value:function(){document.addEventListener("mousemove",this.onDocMouseMove),document.addEventListener("mouseup",this.onDocMouseUp),document.addEventListener("mouseleave",this.onDocMouseLeave)}},{key:"unbindDocEvents",value:function(){document.removeEventListener("mousemove",this.onDocMouseMove),document.removeEventListener("mouseup",this.onDocMouseUp),document.removeEventListener("mouseleave",this.onDocMouseLeave)}},{key:"onVBarMouseDown",value:function(e){this.activeBarObj=this.bar.v,this.moveBegin(e)}},{key:"onHBarMouseDown",value:function(e){this.activeBarObj=this.bar.h,this.moveBegin(e)}},{key:"onDocMouseMove",value:function(e){this.moveUpdate(e)}},{key:"onDocMouseUp",value:function(e){this.moveEnd(e)}},{key:"onDocMouseLeave",value:function(e){this.moveEnd(e)}},{key:"moveBegin",value:function(e){var t=this.activeBarObj,o=this.scrollEl;null!==t&&(o.style.userSelect="none",o.style.pointerEvents="none",this.bindDocEvents(),t.moveStart=e[t.moveProp],t.scrollBefore=o[t.scrollProp])}},{key:"moveUpdate",value:function(e){var t=this.activeBarObj;null!==t&&(t.moveDiff=e[t.moveProp]-t.moveStart,this.barMoveToScroll(t))}},{key:"moveEnd",value:function(){var e=this.activeBarObj,t=this.scrollEl;null!==e&&(this.unbindDocEvents(),e.moveStart=null,e.moveDiff=0,e.scrollBefore=null,this.activeBarObj=null,t.style.userSelect="",t.style.pointerEvents="")}},{key:"setBarsSize",value:function(){var e=this.scrollEl,t=this.maskEl,o=this.bar,s=o.v,i=o.h,n=e.scrollHeight-s.forceSize,l=t.offsetHeight,r=l/n;s.trackSize=l,s.sizeFract=r,s.scrollRange=n-l,s.el&&(s.trackEl.style.display=1===s.sizeFract?"none":"",s.el.style.height=r*s.trackEl.offsetHeight+"px",s.moveRange=s.trackEl.offsetHeight-s.el.offsetHeight);var a=e.scrollWidth-2*i.forceSize,c=t.offsetWidth,v=c/a;i.trackSize=c,i.sizeFract=v,i.scrollRange=a-c,i.el&&(i.trackEl.style.display=1===i.sizeFract?"none":"",i.el.style.width=v*i.trackEl.offsetWidth+"px",i.moveRange=i.trackEl.offsetWidth-i.el.offsetWidth)}},{key:"setBarsPos",value:function(){var e=this.scrollEl,t=this.bar,o=this.progress,s=this.event,i=this.rootEl,n=t.v,l=t.h,r={v:0,h:0};if(n.el){r.v=n.scrollRange?e.scrollTop/n.scrollRange:0;var a=r.v*(n.trackSize*(1-n.sizeFract));n.el.style.transform="translateY("+a+"px)"}if(l.el){r.h=l.scrollRange?e.scrollLeft/l.scrollRange:0;var c=r.h*(l.trackSize*(1-l.sizeFract));l.el.style.transform="translateX("+c+"px)"}s.onScroll(r,i),r.v!==o.v&&(r.v<=0&&s.onTop(i),r.v>=1&&s.onBottom(i),o.v=r.v),r.h!==o.h&&(r.h<=0&&s.onLeft(i),r.h>=1&&s.onRight(i),o.h=r.h)}},{key:"barMoveToScroll",value:function(e){this.scrollEl[e.scrollProp]=e.scrollBefore+e.scrollRange*e.moveDiff/e.moveRange}},{key:"refreshParents",value:function(){window.CustomEvent&&this.rootEl.parentElement.dispatchEvent(new CustomEvent("PotatoScroll.nestedCreate",{bubbles:!0}))}},{key:"refresh",value:function(){this.setBarsSize(),this.setBarsPos()}},{key:"destroy",value:function(){var e=this.scrollEl,t=this.maskEl,o=this.rootEl,s=this.cssClass;for(o.classList.remove(s),o.style.overflow="",o.style.position="",o.style.display="";e.childNodes.length;)o.appendChild(e.childNodes[0]);t.removeChild(e),o.removeChild(t)}}]),e}();t.default=i}]).default;